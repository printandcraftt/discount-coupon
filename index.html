<!DOCTYPE html>
<html>
<head>
  <title>Print & Craft - Surprise Discount</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(270deg, #6a00ff, #a64dff, #7b2cff);
      background-size: 400% 400%;
      animation: gradientMove 15s ease infinite;
      overflow: hidden;
      color: white;
      text-align: center;
      padding: 20px;
      position: relative;
    }

    @keyframes gradientMove {
      0% {background-position: 0% 50%;}
      50% {background-position: 100% 50%;}
      100% {background-position: 0% 50%;}
    }

    /* Floating background shapes */
    .floating {
      position: absolute;
      border-radius: 50%;
      background: rgba(255,255,255,0.15);
      animation: float 20s linear infinite;
    }

    @keyframes float {
      0% { transform: translateY(100vh); }
      100% { transform: translateY(-120vh); }
    }

    .brand {
      position: absolute;
      top: 20px;
      font-size: 20px;
      font-weight: bold;
      z-index: 2;
    }

    .card {
      width: 100%;
      max-width: 340px;
      background: rgba(255,255,255,0.12);
      backdrop-filter: blur(15px);
      padding: 30px 20px;
      border-radius: 20px;
      box-shadow: 0 15px 40px rgba(0,0,0,0.3);
      z-index: 2;
    }

    h1 { font-size: 18px; margin-bottom: 10px; }

    .discount {
      font-size: 36px;
      font-weight: bold;
      margin: 15px 0;
      animation: pop 0.5s ease;
    }

    .legendary {
      color: gold;
      text-shadow: 0 0 15px gold;
    }

    .code { font-size: 15px; margin-top: 8px; }
    .small { font-size: 12px; margin-top: 8px; opacity: 0.9; }

    @keyframes pop {
      0% {transform: scale(0.7);}
      100% {transform: scale(1);}
    }

    /* Loading spinner */
    .spinner {
      width: 50px;
      height: 50px;
      border: 5px solid rgba(255,255,255,0.3);
      border-top: 5px solid white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }

    @keyframes spin {
      0% {transform: rotate(0deg);}
      100% {transform: rotate(360deg);}
    }

    /* Visit Button */
    .visit-btn {
      margin-top: 15px;
      padding: 12px 25px;
      border-radius: 25px;
      border: none;
      background: white;
      color: #6a00ff;
      font-weight: bold;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .visit-btn:hover {
      transform: scale(1.08);
      background: gold;
      color: black;
    }

    canvas {
      position: fixed;
      top: 0;
      left: 0;
      pointer-events: none;
      z-index: 1;
    }
  </style>
</head>

<body>

<!-- Floating shapes -->
<div class="floating" style="width:60px;height:60px;left:10%;animation-duration:18s;"></div>
<div class="floating" style="width:80px;height:80px;left:40%;animation-duration:22s;"></div>
<div class="floating" style="width:70px;height:70px;left:75%;animation-duration:20s;"></div>

<div class="brand">Print & Craft ðŸ’œ</div>
<canvas id="confetti"></canvas>
<div class="card" id="content"></div>

<script>
  const now = new Date();
  const today = now.toDateString();
  const lastPlayed = localStorage.getItem("lastPlayedDate");
  const content = document.getElementById("content");

  function formatDateTime(date) {
    return date.toLocaleString("en-US", {
      month: "long",
      day: "numeric",
      year: "numeric",
      hour: "2-digit",
      minute: "2-digit"
    });
  }

  function goToMain() {
    window.open("https://printandcraftt.github.io/Print_and_Craft_New/", "_blank");
  }

  if (lastPlayed === today) {
    content.innerHTML = `
      <h1>ðŸ’œ Already Claimed Today</h1>
      <p class="small">Come back tomorrow for another chance âœ¨</p>
      <button class="visit-btn" onclick="goToMain()">Visit Our Website</button>
    `;
  } else {

    localStorage.setItem("lastPlayedDate", today);

    content.innerHTML = `
      <h1>âœ¨ Checking Your Luck...</h1>
      <div class="spinner"></div>
      <div class="small">Preparing your reward...</div>
    `;

    setTimeout(() => {

      const discounts = [
        {value: "10% OFF", weight: 50},
        {value: "5% OFF", weight: 43},
        {value: "15% OFF", weight: 5},
        {value: "20% OFF", weight: 2}
      ];

      function getWeightedRandom() {
        let totalWeight = discounts.reduce((sum, item) => sum + item.weight, 0);
        let random = Math.random() * totalWeight;
        for (let item of discounts) {
          if (random < item.weight) return item.value;
          random -= item.weight;
        }
      }

      const randomDiscount = getWeightedRandom();
      const code = "CRAFT-" + Math.random().toString(36).substring(2,8).toUpperCase();
      const dateTime = formatDateTime(now);

      let discountClass = "discount";
      let extraText = "";

      if (randomDiscount === "20% OFF") {
        discountClass += " legendary";
        extraText = "<div class='small'>ðŸ‘‘ Top 2% Winner!</div>";
      }

      content.innerHTML = `
        <h1>ðŸŽ‰ Congratulations!</h1>
        <div class="${discountClass}">${randomDiscount}</div>
        ${extraText}
        <div class="code">Code: ${code}</div>
        <div class="small">Claimed on: ${dateTime}</div>
        <div class="small">Screenshot & send to An DreaðŸ’œ</div>
        <button class="visit-btn" onclick="goToMain()">Visit Our Website</button>
      `;

      startConfetti();

      fetch("https://script.google.com/macros/s/AKfycbzOfS4_Hfd1ngTKnDo24jfeKKGq1mONAQpMUFvE-bw2BNlFWldOzC7fOhIzC-0d2sFg/exec", {
  method: "POST",
  body: JSON.stringify({
    date: now.toLocaleDateString(),
    time: now.toLocaleTimeString(),
    discount: randomDiscount,
    code: code
  })
});

    }, 2500);
  }

  // Confetti
  const canvas = document.getElementById("confetti");
  const ctx = canvas.getContext("2d");
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  const pieces = [];
  for (let i = 0; i < 60; i++) {
    pieces.push({
      x: Math.random() * canvas.width,
      y: Math.random() * canvas.height - canvas.height,
      size: Math.random() * 6 + 3,
      speed: Math.random() * 2 + 1,
      color: `hsl(${Math.random() * 360}, 70%, 60%)`
    });
  }

  function startConfetti() {
    function update() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      for (let p of pieces) {
        ctx.fillStyle = p.color;
        ctx.fillRect(p.x, p.y, p.size, p.size);
        p.y += p.speed;
        if (p.y > canvas.height) p.y = -10;
      }
      requestAnimationFrame(update);
    }
    update();
  }
</script>

</body>
</html>
